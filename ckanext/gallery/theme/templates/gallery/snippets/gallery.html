<div id="gallery" data-toggle="modal-gallery" data-target="#modal-gallery">
   
<script>
$('#dataTable').paging({limit:5});
</script>

<h2>Buscar</h2>

<input type="text" id="searchInDataTableInput" onkeyup="searchFunction()" placeholder="Search for all fields.." title="Type in a name">
							

 <div class="row">
<div id="paginador"></div>
<table id="dataTable" WIDTH="100%">
		{% if images[0]['record'] %} 		
			<tr class="header" WIDTH='10%'"> <!--printing headers-->
				{% for field in images[0]['record'] %}			
		         		<th> {{ field }} </th> 
				{% endfor %}
			</tr>
		{% else %}
			<p> No data in images[0]['record'] </p> 
		{% endif %} 
     
 {% for image in images %}

            <div class="gallery-image col2 span2">

                {# Allow passing in descrtipton to ovveride #}
                {% if not image.description %}

                    {# Check we have package_name and resource_id - these are set up in template variables
                    for the main gallery view, but this snippet can be used elsewhere #}
                    {% if package_name and resource_id %}
                        {% set url = h.url_for(controller='ckanext.nhm.controllers.record:RecordController', action='view', package_name=package_name, resource_id=resource_id, record_id=image['record_id']) %}
                        {#% set description = "<a href='%s'>View</a>" % url %#}               
		    {% endif %}
                {% else %}
                    {% set description = image.description %}
                {%  endif %}

			

<!--
                <a href="{{ image.url }}" title="{{ image.modal_title if image.modal_title else '' }}" data-gallery="gallery" data-description="{{ description }}" class="gallery-thumbnail">
                    <img src="{{ image.thumbnail or image.url }}" alt="{{ image.gallery_title or image.modal_title }}" />
                </a>
                {% if image.gallery_title %}
                    <p>{{ image.gallery_title }}</p>
                {% endif %}
		-->
	
		
			
			<tr>
				{% for field in image['record'] %}			 
					{% set value = image['record'][field] %}
					{% if 'http' in value|string() %}
					<td><a href="{{ image.url }}">
     				              <img src="{{ image.thumbnail or image.url }}" alt="{{ image.gallery_title or image.modal_title }}"  width="80" height="80"></img>
     		 			</a></td>	
					 
					{% else %}
						<td> {{ value }} </td>
					{% endif %}
				{% endfor %}
			</tr>
		
            </div>
        {% endfor %}

</table>
</div>
<!--
<script>
function searchFunction() {
  var input, filter, table, tr, td, i;
  input = document.getElementById("searchInDataTableInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("dataTable");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) { 
    td = tr[i].getElementsByTagName("td")[9];
    if (td) {
      if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
</script>
-->

<script>



function searchFunction() {
  var input, filter, table, tr, td, i, string, find;
  input = document.getElementById("searchInDataTableInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("dataTable");
  tr = table.getElementsByTagName("tr");
  for (i = 1; i < tr.length; i++) { 
    td = tr[i].getElementsByTagName("td");
    find = false;
    for (j = 0; j < td.length; j++) { 
       if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
		find = true;      
        }
    }

       if (find==true) { 
          tr[i].style.display = "";
       } else {
          tr[i].style.display = "none";
       }

  }
}

}








(function($) {
    $(function() {
        $.widget("zpd.paging", {
            options: {
                limit: 5,
                rowDisplayStyle: 'block',
                activePage: 0,
                rows: []
            },
            _create: function() {
                var rows = $("tbody", this.element).children();
                this.options.rows = rows;
                this.options.rowDisplayStyle = rows.css('display');
                var nav = this._getNavBar();
                this.element.after(nav);
                this.showPage(0);
            },
            _getNavBar: function() {
                var rows = this.options.rows;
                var nav = $('<div>', {class: 'paging-nav'});
                for (var i = 0; i < Math.ceil(rows.length / this.options.limit); i++) {
                    this._on($('<a>', {
                        href: '#',
                        text: (i + 1),
                        "data-page": (i)
                    }).appendTo(nav),
                            {click: "pageClickHandler"});
                }
                //create previous link
                this._on($('<a>', {
                    href: '#',
                    text: '<<',
                    "data-direction": -1
                }).prependTo(nav),
                        {click: "pageStepHandler"});
                //create next link
                this._on($('<a>', {
                    href: '#',
                    text: '>>',
                    "data-direction": +1
                }).appendTo(nav),
                        {click: "pageStepHandler"});
                return nav;
            },
            showPage: function(pageNum) {
                var num = pageNum * 1; //it has to be numeric
                this.options.activePage = num;
                var rows = this.options.rows;
                var limit = this.options.limit;
                for (var i = 0; i < rows.length; i++) {
                    if (i >= limit * num && i < limit * (num + 1)) {
                        $(rows[i]).css('display', this.options.rowDisplayStyle);
                    } else {
                        $(rows[i]).css('display', 'none');
                    }
                }
            },
            pageClickHandler: function(event) {
                event.preventDefault();
                $(event.target).siblings().attr('class', "");
                $(event.target).attr('class', "selected-page");
                var pageNum = $(event.target).attr('data-page');
                this.showPage(pageNum);
            },
            pageStepHandler: function(event) {
                event.preventDefault();
                //get the direction and ensure it's numeric
                var dir = $(event.target).attr('data-direction') * 1;
                var pageNum = this.options.activePage + dir;
                //if we're in limit, trigger the requested pages link
                if (pageNum >= 0 && pageNum < this.options.rows.length) {
                    $("a[data-page=" + pageNum + "]", $(event.target).parent()).click();
                }
            }
        });
    });
})(jQuery);








</script>

    
  </div>

{% resource 'ckanext-gallery/main' %}

{% include "gallery/snippets/lightbox.html" %}
