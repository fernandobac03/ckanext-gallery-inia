<div id="gallery" data-toggle="modal-gallery" data-target="#modal-gallery">
   

<h2>Buscar</h2>

<input type="text" id="searchInDataTableInput" onkeyup="searchFunction()" placeholder="Search for all fields.." title="Type in a name">
							

 <div class="row">
<div id="paginador"></div>
<table id="dataTable" WIDTH="100%">
		{% if images[0]['record'] %} 		
			<tr class="header" WIDTH='10%'"> <!--printing headers-->
				{% for field in images[0]['record'] %}			
		         		<th> {{ field }} </th> 
				{% endfor %}
			</tr>
		{% else %}
			<p> No data in images[0]['record'] </p> 
		{% endif %} 
     
 {% for image in images %}

            <div class="gallery-image col2 span2">

                {# Allow passing in descrtipton to ovveride #}
                {% if not image.description %}

                    {# Check we have package_name and resource_id - these are set up in template variables
                    for the main gallery view, but this snippet can be used elsewhere #}
                    {% if package_name and resource_id %}
                        {% set url = h.url_for(controller='ckanext.nhm.controllers.record:RecordController', action='view', package_name=package_name, resource_id=resource_id, record_id=image['record_id']) %}
                        {#% set description = "<a href='%s'>View</a>" % url %#}               
		    {% endif %}
                {% else %}
                    {% set description = image.description %}
                {%  endif %}

			

<!--
                <a href="{{ image.url }}" title="{{ image.modal_title if image.modal_title else '' }}" data-gallery="gallery" data-description="{{ description }}" class="gallery-thumbnail">
                    <img src="{{ image.thumbnail or image.url }}" alt="{{ image.gallery_title or image.modal_title }}" />
                </a>
                {% if image.gallery_title %}
                    <p>{{ image.gallery_title }}</p>
                {% endif %}
		-->
	
		
			
			<tr>
				{% for field in image['record'] %}			 
					{% set value = image['record'][field] %}
					{% if 'http' in value|string() %}
					<td><a href="{{ image.url }}">
     				              <img src="{{ image.thumbnail or image.url }}" alt="{{ image.gallery_title or image.modal_title }}"  width="80" height="80"></img>
     		 			</a></td>	
					 
					{% else %}
						<td> {{ value }} </td>
					{% endif %}
				{% endfor %}
			</tr>
		
            </div>
        {% endfor %}

</table>
</div>
<!--
<script>
function searchFunction() {
  var input, filter, table, tr, td, i;
  input = document.getElementById("searchInDataTableInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("dataTable");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) { 
    td = tr[i].getElementsByTagName("td")[9];
    if (td) {
      if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
</script>
-->

<script>
var p = new Paginador(
    document.getElementById('paginador'),
    document.getElementById('dataTable'),
    4
);
p.Mostrar();



Paginador = function(divPaginador, tabla, tamPagina)
{
    this.miDiv = divPaginador; //un DIV donde irán controles de paginación
    this.tabla = tabla;           //la tabla a paginar
    this.tamPagina = tamPagina; //el tamaño de la página (filas por página)
    this.pagActual = 1;         //asumiendo que se parte en página 1
    this.paginas = Math.floor((this.tabla.rows.length - 1) / this.tamPagina); //¿?
 
    this.SetPagina = function(num)
    {
        if (num < 0 || num > this.paginas)
            return;
 
        this.pagActual = num;
        var min = 1 + (this.pagActual - 1) * this.tamPagina;
        var max = min + this.tamPagina - 1;
 
        for(var i = 1; i < this.tabla.rows.length; i++)
        {
            if (i < min || i > max)
                this.tabla.rows[i].style.display = 'none';
            else
                this.tabla.rows[i].style.display = '';
        }
        this.miDiv.firstChild.rows[0].cells[1].innerHTML = this.pagActual;
    }
 
    this.Mostrar = function()
    {
        //Crear la tabla
        var tblPaginador = document.createElement('table');
 
        //Agregar una fila a la tabla
        var fil = tblPaginador.insertRow(tblPaginador.rows.length);
 
        //Ahora, agregar las celdas que serán los controles
        var ant = fil.insertCell(fil.cells.length);
        ant.innerHTML = 'Anterior';
        ant.className = 'pag_btn'; //con eso le asigno un estilo
        var self = this;
        ant.onclick = function()
        {
            if (self.pagActual == 1)
                return;
            self.SetPagina(self.pagActual - 1);
        }
 
        var num = fil.insertCell(fil.cells.length);
        num.innerHTML = ''; //en rigor, aún no se el número de la página
        num.className = 'pag_num';
 
        var sig = fil.insertCell(fil.cells.length);
        sig.innerHTML = 'Siguiente';
        sig.className = 'pag_btn';
        sig.onclick = function()
        {
            if (self.pagActual == self.paginas)
                return;
            self.SetPagina(self.pagActual + 1);
        }
 
        //Como ya tengo mi tabla, puedo agregarla al DIV de los controles
        this.miDiv.appendChild(tblPaginador);
 
        //¿y esto por qué?
        if (this.tabla.rows.length - 1 > this.paginas * this.tamPagina)
            this.paginas = this.paginas + 1;
 
        this.SetPagina(this.pagActual);
    }


function searchFunction() {
  var input, filter, table, tr, td, i, string, find;
  input = document.getElementById("searchInDataTableInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("dataTable");
  tr = table.getElementsByTagName("tr");
  for (i = 1; i < tr.length; i++) { 
    td = tr[i].getElementsByTagName("td");
    find = false;
    for (j = 0; j < td.length; j++) { 
       if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
		find = true;      
        }
    }

       if (find==true) { 
          tr[i].style.display = "";
       } else {
          tr[i].style.display = "none";
       }

  }
}


}




</script>

    
  </div>

{% resource 'ckanext-gallery/main' %}

{% include "gallery/snippets/lightbox.html" %}
